!function(e){function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=1)}([function(e,n,t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e){var n=e.resources,t=void 0===n?[]:n,o=e.pageId,r=void 0===o?window.location:o,c=e.indexedDB,i=void 0===c?window.indexedDB:c;(0,u.default)(r,i).then(function(e){t.filter(function(e){return!e.cacheOnly}).concat(t.filter(function(e){return e.cacheOnly})).forEach(function(n){var t=n.url,o=n.type,r=void 0===o?"script":o,c=n.target,i=void 0===c?"head":c,u=n.loadAsync,a=void 0!==u&&u,d=n.cacheOnly,p=void 0!==d&&d,g=l.default[r],y=p?v:document,w=y.createElement(g.tagName);e.getResource((0,s.id)(t)).then(function(e){console.log("resource "+t+" was in cache"),g.appendTextContent(w,y,e)}).catch(function(n){console.log(n?"failed to fetch resource from cache "+t+". error: "+n:"resource "+t+" was not in cache"),w.setAttribute(g.contentFetchKey,t),setTimeout(function(){return h(t,e)},f)}).then(function(){a&&"script"===r&&w.setAttribute("async","async"),Object.keys(g.props).forEach(function(e){return w.setAttribute(e,g.props[e])}),y[i].appendChild(w)})});var n=t.map(function(e){return(0,s.id)(e.url)});p=p.concat(n)})}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.indexedDB;(0,u.default)(e,n).then(function(e){e.pruneDb(p)})}Object.defineProperty(n,"__esModule",{value:!0}),n.load=r,n.pruneDB=c;var i=t(3),u=o(i),s=t(2),a=t(4),d=t(5),l=o(d),f=1e3,p=[],h=function(e,n){(0,a.fetchImage)(e).then(function(t){n.putResource((0,s.id)(e),t)})},v={createElement:function(){return{appendChild:Function.prototype,setAttribute:Function.prototype}},head:{appendChild:Function.prototype},body:{appendChild:Function.prototype},createTextNode:Function.prototype}},function(e,n,t){"use strict";var o=t(0);!function(){var e=window.cappCacheResources||{resources:[]},n=e.pageId||window.location;(0,o.load)({manifest:e,pageId:n,indexedDB:window.indexedDB}),window.cappCache={load:o.load,pruneDB:o.pruneDB}}()},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.id=function(e){return e}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,n){var t=Object.create(null),i=null,u=n.open(o,r),s=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"readwrite";return i.transaction([e],n).objectStore(e)};return t.getResource=function(e){return new Promise(function(n,t){var o=s("readonly").get(e);o.onsuccess=function(o){o.target.result?n(o.target.result.content):(console.log("resource with id "+e+" is not in the cache"),t(null))},o.onerror=function(e){t(e)}})},t.removeResource=function(e){return new Promise(function(n,t){var o=s(),r=o.delete(e);r.onsuccess=function(){console.log("removed resource "+e),n()},r.onerror=function(n){console.error("failed to remove resource "+e+". error: "+n),t(n)}})},t.putResource=function(e,n){return new Promise(function(t,o){var r=s(),i=r.put({id:e,content:n});i.onsuccess=function(){c&&console.log("successfully saved item id "+e+" in cache"),t()},i.onerror=function(n){console.error("failed to save item with id "+e+" in cache due to error "+n),o()}})},t.pruneDb=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Promise(function(n,o){var r=s(),c=r.openCursor();c.onsuccess=function(o){var r=o.target.result;r?(e.includes(r.key)||(t.removeResource(r.key),console.log("pruned "+r.key)),r.continue()):n()},c.onerror=function(e){console.error("failed to get all keys while pruning cache. error"),o(e)}})},new Promise(function(n,o){u.onsuccess=function(e){i=e.target.result,n(t)},u.onupgradeneeded=function(n){var t=n.target.result;if(n.oldVersion>0)try{t.deleteObjectStore(e)}catch(n){console.log("exception when trying to delete object store during onupgradeneeded. "+JSON.stringify(n))}t.createObjectStore(e,{keyPath:"id"})},u.onerror=function(e){console.error("failed to open indexedDB "+JSON.stringify(e)),o(e)}})};var o="RESOURCE_CACHE",r=3,c=!1},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.fetchImage=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text";return new Promise(function(t,o){var r=new XMLHttpRequest,c=null;r.open("GET",e,!0),r.responseType=n,r.addEventListener("load",function(){200===r.status?(c=r.response,t(c)):o(r)},!1),r.send()})}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default={script:{tagName:"script",contentFetchKey:"src",props:{type:"text/javascript"},appendTextContent:function(e,n,t){e.appendChild(n.createTextNode(t))}},css:{tagName:"link",contentFetchKey:"href",props:{rel:"stylesheet"},appendTextContent:function(e,n,t){e.innerHTML=t}}}}]);